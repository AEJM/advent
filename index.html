<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calendario de AdvientAnita</title>

<!-- Google Font: Mountains of Christmas -->
<link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#9b0505;
  --text:#fff;
  --card:rgba(255,255,255,0.18);
  --modal-bg: rgba(255,255,255,0.60); /* 60% transparencia */
}

*{ box-sizing:border-box; }

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family: "Mountains of Christmas", cursive;
  padding:20px;
  min-height:100vh;
  overflow-x:hidden;
}

/* Header */
header{ text-align:center; margin-bottom:18px; }
h1{
  font-size:60px;
  margin:0;
  text-shadow:0 0 12px rgba(0,0,0,0.45);
  line-height:1;
}

/* Grid base */
.grid{
  display:grid;
  gap:10px;
  width:100%;
  margin-top:18px;
}

/* Layout breakpoints to make all 25 blocks fit vertically on wide screens */
@media (min-width: 1400px){
  .grid{ grid-template-columns: repeat(5,1fr); max-width:1200px; margin:18px auto; }
}
@media (min-width: 1000px) and (max-width:1399px){
  .grid{ grid-template-columns: repeat(5,1fr); max-width:1000px; margin:18px auto; }
}
@media (min-width: 700px) and (max-width:999px){
  .grid{ grid-template-columns: repeat(4,1fr); max-width:900px; margin:18px auto; }
}
@media (max-width:699px){
  .grid{ grid-template-columns: repeat(3,1fr); max-width:720px; margin:8px auto; }
}
@media (max-width:460px){
  .grid{ grid-template-columns: repeat(2,1fr); max-width:420px; margin:8px auto; }
}

/* Day squares */
.day{
  background:var(--card);
  border:2px solid rgba(255,255,255,0.55);
  color:white;
  cursor:pointer;
  border-radius:12px;
  aspect-ratio:1 / 1;  /* cuadrado perfecto */
  display:flex;
  justify-content:center;
  align-items:center;
  font-size: clamp(22px, 4vw, 48px);
  text-shadow:0 0 8px rgba(0,0,0,0.4);
  backdrop-filter:blur(4px);
  position:relative;
  transition: transform .15s ease, box-shadow .15s ease;
  user-select:none;
}

@media (min-width:1000px){
  .day{ font-size: 36px; }
  .grid{ max-width:1100px; }
}

.day:hover:not(.locked){ transform:translateY(-6px); box-shadow:0 12px 22px rgba(0,0,0,0.3); }
.locked{ opacity:0.42; cursor:not-allowed; transform:none !important; }

/* Modal overlay */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease;
  z-index:40;
}
.overlay.show{ opacity:1; pointer-events:auto; }

/* Modal box */
.modal{
  width:min(92%,760px);
  background: var(--modal-bg);
  backdrop-filter: blur(8px);
  color:#1b1b1b;
  border-radius:18px;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:14px;
  align-items:center;
}

/* Modal content */
.modal h2{ margin:0; font-size:34px; color:#9b0505; font-family:"Mountains of Christmas"; }
.modal p{ margin:0; font-size:18px; text-align:center; color:#222; }

/* Player container */
#playerContainer{ width:100%; display:flex; justify-content:center; margin-top:6px; }

/* Gift area */
#modalGift{ width:100%; display:flex; justify-content:center; margin-top:6px; }

/* Close button */
.close{
  background:#9b0505; color:white; border:none; padding:10px 18px; border-radius:12px; cursor:pointer;
  font-family:"Mountains of Christmas"; font-size:18px;
}

/* Snow */
.snowflake{ position:fixed; top:-10px; color:white; opacity:0.9; font-size:12px; user-select:none; pointer-events:none; animation:fall linear forwards; }
@keyframes fall{ 0%{ transform:translateY(-10px) translateX(0); opacity:1; } 100%{ transform:translateY(110vh) translateX(20px); opacity:0; } }
</style>
</head>

<body>

<header>
  <h1>Calendario de AdvientAnita</h1>
</header>

<section class="grid" id="grid" aria-label="Calendario de Adviento"></section>

<!-- Modal -->
<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal" role="document">
    <h2 id="modalTitle">Día</h2>
    <p id="modalText">Texto motivador</p>

    <div id="modalGift" aria-hidden="true"></div>

    <div id="playerContainer" aria-hidden="true"></div>

    <button id="closeBtn" class="close">Cerrar</button>
  </div>
</div>

<script>
/* ====== Datos ====== */
const frases = [
  "Que el espíritu navideño encienda tu sonrisa y tu esperanza.",
  "Pequeños gestos, grandes alegrías.",
  "Que la magia de diciembre te recuerde lo valiente que eres.",
  "Regala tiempo: las mejores memorias no se envuelven.",
  "Calma y abrazos: hoy es un buen día.",
  "Hoy recuerda: mereces alegría.",
  "Que la noche traiga paz y la mañana nuevas oportunidades.",
  "Ríe de lo simple y celebra lo inesperado.",
  "Abre tu corazón: la generosidad regresa.",
  "Una vela, un deseo.",
  "Pequeños pasos construyen grandes historias.",
  "Hoy alguien piensa en ti.",
  "Que la música y la risa llenen tu día.",
  "Recuerda descansar: también es un regalo.",
  "Una sonrisa puede cambiarlo todo.",
  "Atrévete a soñar.",
  "Haz una pausa y agradece.",
  "La bondad es contagiosa.",
  "Abraza el presente.",
  "Siembra una idea amable.",
  "Que la esperanza te acompañe.",
  "Cree en lo pequeño.",
  "La ternura construye puentes.",
  "Celebra lo que importa.",
  "Último empujón del mes: ¡ánimo!"
];

/* Días con regalo */
const diasConRegalo = new Set([5,9,15,18]);

/* Canciones — usar embed base */
const embedBase = "https://open.spotify.com/embed/track/";
const trackIds = {
  1:"3QiAAp20rPC3dcAtKtMaqQ",
  2:"4fzyvSu73BhGvi96p2zwjL",
  3:"1yxcKrEcxt4O03IIC25yHk",
  4:"7fUYUcWy853HS8YJn0b3Sr",
  5:"3e18zWToEVj78u6sfr6872?",
  6:"6syO6UTl8QiiWADJy3Uy2d",
  7:"0IrKbfhVKW0xpPEzRDeSUb",
  8:"34zJEmGCjFQTV9SKG4nX2e",
  9:"2EjXfH91m7f8HiJN1yQg97",
  10:"7uoFMmxln0GPXQ0AcCBXRq",
  11:"34HnsDct5xX1vfcz3LaQQs",
  12:"1ZKuSGOgsXAaG5h9kboNwH",
  13:"65irrLqfCMRiO3p87P4C0D",
  14:"5hslUAKq9I9CG2bAulFkHN",
  15:"3YZE5qDV7u1ZD1gZc47ZeR",
  16:"1TQGYhufxXY1YiYjI3gdSd",
  17:"2FRnf9qhLbvw8fu4IBXx78",
  18:"0bYg9bo50gSsH3LtXe2SQn",
  19:"5hslUAKq9I9CG2bAulFkHN",
  20:"6rqn19AqjcM5wgI1hCYciJ",
  21:"2QpN1ZVw8eJO5f7WcvUA1k",
  22:"2FRnf9qhLbvw8fu4IBXx78",
  23:"4KV9bM7a1KDc7b7OakFZic",
  24:"0OlwVgiXo2qkwAI84wmTLj",
  25:"0mSH3qaoRskcre3noTXbcB"
};

/* Fecha */
const now = new Date();
const isDecember = (now.getMonth()+1) === 12;
const today = now.getDate();

/* Grid build */
const grid = document.getElementById('grid');
for(let i=1;i<=25;i++){
  const cell = document.createElement('div');
  cell.className = 'day';
  cell.dataset.day = i;
  cell.textContent = i;

  // ❌ Eliminado: Ya no se muestra el regalo en la vista principal

  // lock future days
  if(!(isDecember && i <= today)){
    cell.classList.add('locked');
  }

  grid.appendChild(cell);
}

/* Modal refs */
const overlay = document.getElementById('overlay');
const modalTitle = document.getElementById('modalTitle');
const modalText = document.getElementById('modalText');
const modalGift = document.getElementById('modalGift');
const playerContainer = document.getElementById('playerContainer');
const closeBtn = document.getElementById('closeBtn');

/* Helper to stop/remove iframe player */
function removePlayer(){
  playerContainer.innerHTML = '';
  playerContainer.setAttribute('aria-hidden','true');
}

/* Open handler */
grid.addEventListener('click', (e) => {
  const tile = e.target.closest('.day');
  if(!tile) return;
  const d = Number(tile.dataset.day);

  if(tile.classList.contains('locked')){
    alert('Ese día aún no se puede abrir.');
    return;
  }

  modalTitle.textContent = 'Día ' + d;
  modalText.textContent = frases[d-1] || '';

  // gift in modal
  if(diasConRegalo.has(d)){
    modalGift.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1139/1139982.png" alt="regalo" width="140" style="filter: drop-shadow(0 6px 10px rgba(0,0,0,0.25)); border-radius:8px;">`;
    modalGift.setAttribute('aria-hidden','false');
  } else {
    modalGift.innerHTML = '';
    modalGift.setAttribute('aria-hidden','true');
  }

  // player
  removePlayer();
  const id = trackIds[d];
  if(id){
    const iframe = document.createElement('iframe');
    iframe.src = embedBase + encodeURIComponent(id);
    iframe.width = '100%';
    iframe.height = '152';
    iframe.frameBorder = '0';
    iframe.allow = 'autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture';
    iframe.style.borderRadius = '12px';
    iframe.loading = 'lazy';
    playerContainer.appendChild(iframe);
    playerContainer.setAttribute('aria-hidden','false');
  }

  overlay.classList.add('show');
  overlay.setAttribute('aria-hidden','false');
});

/* Close modal */
function closeModal(){
  overlay.classList.remove('show');
  overlay.setAttribute('aria-hidden','true');
  removePlayer();
}
closeBtn.addEventListener('click', closeModal);
overlay.addEventListener('click', (ev) => { if(ev.target === overlay) closeModal(); });
document.addEventListener('keydown', (ev) => { if(ev.key === 'Escape' && overlay.classList.contains('show')) closeModal(); });

/* Snow */
function spawnSnow(){
  const s = document.createElement('div');
  s.className = 'snowflake';
  s.textContent = '❄';
  s.style.left = Math.random()*100 + 'vw';
  s.style.fontSize = (10 + Math.random()*14) + 'px';
  s.style.animationDuration = (6 + Math.random()*7) + 's';
  document.body.appendChild(s);
  setTimeout(()=> s.remove(), 10000);
}
setInterval(spawnSnow, 180);

</script>
</body>
</html>
